<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - Floria Premium Flower Boutique</title>
    <meta name="description" content="Review your cart and checkout at Floria.">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŒ¸</text></svg>">

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/cart.css">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-main">
            <a href="index.html" class="logo">Floria<sub class="small">.com</sub></a>
            <nav class="navbar">
                <a href="index.html#home">Home</a>
                <a href="index.html#shop">Shop By</a>
                <a href="index.html#collections">Collections</a>
                <a href="index.html#services">Services</a>
                <a href="about.html">About</a>
                <a href="contact.html">Contact</a>
            </nav>
            <div class="icons">
                <div id="search-btn" class="fas fa-search"></div>
                <div id="user-btn" class="fas fa-user"></div>
                <div id="cart-btn" class="fas fa-shopping-bag"><span>(0)</span></div>
                <div id="menu-btn" class="fas fa-bars"></div>
            </div>
        </div>
        <form action="" class="search-form">
            <input type="search" id="search-box" placeholder="Search for products...">
            <label for="search-box" class="fas fa-search"></label>
        </form>
    </header>

    <!-- Cart Section -->
    <section class="cart-section">
        <div class="page-header">
            <div class="breadcrumb">
                <a href="index.html">Home</a>
                <span>/</span>
                <span>Shopping Cart</span>
            </div>
            <h1>Your <span>Cart</span></h1>
        </div>

        <div class="cart-wrapper" id="cartWrapper">
            <!-- Cart Content will be rendered by JavaScript -->
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-grid">
            <div class="footer-box about-us">
                <h3>Floria</h3>
                <p>Premium online flower boutique with 99+ beautiful arrangements for every occasion.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
            <div class="footer-box links">
                <h3>Quick Links</h3>
                <a href="index.html">Home</a>
                <a href="index.html#collections">Collections</a>
                <a href="about.html">About Us</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="footer-box links">
                <h3>Help</h3>
                <a href="#">FAQs</a>
                <a href="#">Shipping Info</a>
                <a href="#">Returns</a>
                <a href="#">Track Order</a>
            </div>
            <div class="footer-box newsletter">
                <h3>Newsletter</h3>
                <p>Subscribe for special offers!</p>
                <form>
                    <input type="email" placeholder="Your email" class="email-input">
                    <button type="submit" class="subscribe-btn">Subscribe</button>
                </form>
            </div>
        </div>
        <div class="credit">Â© 2024 <a href="index.html">Floria</a> | Premium Flower Boutique</div>
    </footer>

    <!-- External JavaScript -->


    <!-- Cart JavaScript -->
    <script>
        // ===== HEADER LOGIC =====
        function initHeader() {
            // User Button
            const userBtn = document.querySelector('#user-btn');
            if (userBtn) {
                userBtn.onclick = (e) => {
                    e.preventDefault();
                    const user = JSON.parse(localStorage.getItem('floriaUser')) || JSON.parse(sessionStorage.getItem('floriaUser'));
                    if (user && user.loggedIn) {
                        if (confirm('Sign out?')) {
                            localStorage.removeItem('floriaUser');
                            sessionStorage.removeItem('floriaUser');
                            window.location.reload();
                        }
                    } else {
                        window.location.href = 'signin.html';
                    }
                };
                // Update Icon
                const user = JSON.parse(localStorage.getItem('floriaUser')) || JSON.parse(sessionStorage.getItem('floriaUser'));
                if (user && user.loggedIn) userBtn.style.color = '#e84393';
            }
            // Cart Button (already on cart page, maybe refresh?)
            const cartBtn = document.querySelector('#cart-btn');
            if (cartBtn) cartBtn.onclick = (e) => { e.preventDefault(); window.location.reload(); };
        }
        document.addEventListener('DOMContentLoaded', initHeader);

        // ===== CART PAGE FUNCTIONALITY =====
        let cart = JSON.parse(localStorage.getItem('floriaCart')) || [];

        // Toast notification
        function showToast(message) {
            const existing = document.querySelector('.toast-notification');
            if (existing) existing.remove();

            const toast = document.createElement('div');
            toast.className = 'toast-notification show';
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(45deg, #333, #555);
                color: white;
                padding: 1rem 2rem;
                border-radius: 30px;
                font-weight: 500;
                z-index: 99999;
                font-size: 14px;
            `;
            document.body.appendChild(toast);

            setTimeout(() => toast.remove(), 2500);
        }

        // Update cart count in header
        function updateCartCount() {
            document.querySelectorAll('#cart-btn span').forEach(span => {
                span.textContent = `(${cart.length})`;
            });
        }

        // Get cart totals
        function getSubtotal() {
            return cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
        }

        // Render cart
        function renderCart() {
            const wrapper = document.getElementById('cartWrapper');

            if (cart.length === 0) {
                wrapper.innerHTML = `
                    <div class="cart-empty">
                        <div class="empty-icon">ðŸ›’</div>
                        <h2>Your cart is empty</h2>
                        <p>Looks like you haven't added any flowers yet!</p>
                        <a href="view.html" class="btn btn-primary">Browse Products</a>
                    </div>
                `;
                return;
            }

            const subtotal = getSubtotal();
            const shipping = subtotal > 50 ? 0 : 9.99;
            const total = subtotal + shipping;

            wrapper.innerHTML = `
                <div class="cart-items">
                    <table class="cart-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Total</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            ${cart.map((item, index) => `
                                <tr data-index="${index}">
                                    <td class="product-cell">
                                        <div class="product-info">
                                            <div class="product-image">ðŸŒ¸</div>
                                            <div class="product-details">
                                                <h4>${item.name}</h4>
                                                <span class="product-id">ID: ${item.id}</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="price-cell">$${item.price.toFixed(2)}</td>
                                    <td class="quantity-cell">
                                        <div class="quantity-control">
                                            <button class="qty-btn minus" data-index="${index}">âˆ’</button>
                                            <span class="qty-value">${item.quantity}</span>
                                            <button class="qty-btn plus" data-index="${index}">+</button>
                                        </div>
                                    </td>
                                    <td class="total-cell">$${(item.price * item.quantity).toFixed(2)}</td>
                                    <td class="remove-cell">
                                        <button class="remove-btn" data-index="${index}">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div class="cart-actions">
                        <a href="view.html" class="btn btn-outline">
                            <i class="fas fa-arrow-left"></i> Continue Shopping
                        </a>
                        <button class="btn btn-clear" id="clearCart">
                            <i class="fas fa-trash"></i> Clear Cart
                        </button>
                    </div>
                </div>

                <div class="cart-summary">
                    <h3>Order Summary</h3>
                    
                    <div class="summary-row">
                        <span>Subtotal (${cart.length} items)</span>
                        <span>$${subtotal.toFixed(2)}</span>
                    </div>
                    
                    <div class="summary-row">
                        <span>Shipping</span>
                        <span>${shipping === 0 ? '<span class="free">FREE</span>' : '$' + shipping.toFixed(2)}</span>
                    </div>
                    
                    ${subtotal < 50 ? `
                        <div class="shipping-notice">
                            <i class="fas fa-info-circle"></i>
                            Add $${(50 - subtotal).toFixed(2)} more for free shipping!
                        </div>
                    ` : ''}
                    
                    <div class="promo-code">
                        <input type="text" placeholder="Promo code" id="promoInput">
                        <button class="apply-btn" id="applyPromo">Apply</button>
                    </div>
                    
                    <div class="summary-total">
                        <span>Total</span>
                        <span>$${total.toFixed(2)}</span>
                    </div>
                    
                    <button class="checkout-btn" id="checkoutBtn">
                        <i class="fas fa-lock"></i> Proceed to Checkout
                    </button>
                    
                    <div class="secure-badge">
                        <i class="fas fa-shield-alt"></i>
                        Secure checkout powered by SSL
                    </div>
                    
                    <div class="payment-methods">
                        <i class="fab fa-cc-visa"></i>
                        <i class="fab fa-cc-mastercard"></i>
                        <i class="fab fa-cc-amex"></i>
                        <i class="fab fa-cc-paypal"></i>
                    </div>
                </div>
            `;

            attachCartEvents();
        }

        // Attach events to cart elements
        function attachCartEvents() {
            // Quantity buttons
            document.querySelectorAll('.qty-btn.minus').forEach(btn => {
                btn.addEventListener('click', function () {
                    const index = parseInt(this.dataset.index);
                    if (cart[index].quantity > 1) {
                        cart[index].quantity--;
                        saveAndRender();
                    }
                });
            });

            document.querySelectorAll('.qty-btn.plus').forEach(btn => {
                btn.addEventListener('click', function () {
                    const index = parseInt(this.dataset.index);
                    if (cart[index].quantity < 10) {
                        cart[index].quantity++;
                        saveAndRender();
                    }
                });
            });

            // Remove buttons
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const index = parseInt(this.dataset.index);
                    const name = cart[index].name;
                    cart.splice(index, 1);
                    saveAndRender();
                    showToast(`${name} removed from cart`);
                });
            });

            // Clear cart
            document.getElementById('clearCart')?.addEventListener('click', function () {
                if (confirm('Are you sure you want to clear your cart?')) {
                    cart = [];
                    saveAndRender();
                    showToast('Cart cleared');
                }
            });

            // Promo code
            document.getElementById('applyPromo')?.addEventListener('click', function () {
                const code = document.getElementById('promoInput').value.trim();
                if (code.toLowerCase() === 'floria10') {
                    showToast('Promo code applied! 10% off');
                } else if (code) {
                    showToast('Invalid promo code');
                }
            });

            // Checkout
            document.getElementById('checkoutBtn')?.addEventListener('click', function () {
                const user = JSON.parse(localStorage.getItem('floriaUser')) || JSON.parse(sessionStorage.getItem('floriaUser'));
                if (!user || !user.loggedIn) {
                    showToast('Please sign in to checkout');
                    setTimeout(() => window.location.href = 'signin.html', 1500);
                } else {
                    showToast('Thank you for your order! ðŸŒ¸');
                    cart = [];
                    saveAndRender();
                }
            });
        }

        // Save cart and re-render
        function saveAndRender() {
            localStorage.setItem('floriaCart', JSON.stringify(cart));
            updateCartCount();
            renderCart();
        }

        // Header functionality
        const menu = document.querySelector('#menu-btn');
        const navbar = document.querySelector('.navbar');
        const searchForm = document.querySelector('.search-form');

        if (menu) {
            menu.onclick = () => {
                menu.classList.toggle('fa-times');
                navbar.classList.toggle('active');
                searchForm?.classList.remove('active');
            };
        }

        document.querySelector('#search-btn')?.addEventListener('click', () => {
            searchForm?.classList.toggle('active');
            menu?.classList.remove('fa-times');
            navbar?.classList.remove('active');
        });

        document.querySelector('#user-btn')?.addEventListener('click', () => {
            const user = JSON.parse(localStorage.getItem('floriaUser')) || JSON.parse(sessionStorage.getItem('floriaUser'));
            if (user && user.loggedIn) {
                if (confirm(`Signed in as ${user.name}. Sign out?`)) {
                    localStorage.removeItem('floriaUser');
                    sessionStorage.removeItem('floriaUser');
                    showToast('Signed out successfully');
                }
            } else {
                window.location.href = 'signin.html';
            }
        });

        // Newsletter
        document.querySelector('.newsletter form')?.addEventListener('submit', function (e) {
            e.preventDefault();
            const email = this.querySelector('input').value;
            if (email) {
                showToast('Thank you for subscribing! ðŸŒ¸');
                this.querySelector('input').value = '';
            }
        });

        // Initialize
        updateCartCount();
        renderCart();
    </script>
</body>

</html>